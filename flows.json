[{"id":"83532572.bb6958","type":"tab","label":"Main Raspberry Pi","disabled":false,"info":""},{"id":"98156df5.ec21f","type":"tab","label":"Environment","disabled":false,"info":""},{"id":"78ecb57.5c40b4c","type":"tab","label":"Weather","disabled":false,"info":""},{"id":"d6cb01d2.47662","type":"tab","label":"TelegramBot","disabled":false,"info":""},{"id":"d9a38654.e281d8","type":"tab","label":"Clock","disabled":false,"info":""},{"id":"e050fe1f.3b69e","type":"tab","label":"Alexa","disabled":false,"info":""},{"id":"7098b56.4a13c4c","type":"subflow","name":"simpletime","info":"This lightweight sub-flow produces a Date/Time output in different formats for use in node-red flows.  \r\nThe sub-flow creates a `simpletime` node which can be inserted in any running flow, and adds the following messages to the flow; \r\n\r\n* msg.myrawdate: \"2017-11-08T20:36:26.257Z\"\r\n* msg.myepoch: 1510173386257\r\n* msg.mydate: \"Wed Nov 08 2017\"\r\n* msg.myhour: \"20\"\r\n* msg.myminute: \"36\"\r\n* msg.myminutes: \"36:26\"\r\n* msg.mysecond: \"26\"\r\n* msg.mytime: \"20:36\"\r\n* msg.mytimes: \"20:36:26\"\r\n\r\nAll other messages such as msg.payload & topic pass straight through the node unhindered.\r\n\r\nTo introduce any of the messages into a flow, simply assign any, or any combination of the messages into a variable(s), such as; `var seconds = msg.myseconds;`  \r\nor to use in a ui_text node add via mustache `{{msg.mytimes}}` \r\n\r\nFor advanced functionality, I would strongly recommend using the node-red-contrib-moment which is better equipped to handle edge-cases.\r\n\r\nAny feedback - please give me a shout - @rossoreed on [node-red slack](https://nodered.org/slack)","in":[{"x":174,"y":108,"wires":[{"id":"f8b07e20.a2ca1"}]}],"out":[{"x":488,"y":108,"wires":[{"id":"f8b07e20.a2ca1","port":0}]}]},{"id":"68e1211f.1a3b2","type":"ui_base","theme":{"name":"theme-dark","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#097479","value":"#097479","edited":false},"page-titlebar-backgroundColor":{"value":"#097479","edited":false},"page-backgroundColor":{"value":"#111111","edited":false},"page-sidebar-backgroundColor":{"value":"#000000","edited":false},"group-textColor":{"value":"#0eb8c0","edited":false},"group-borderColor":{"value":"#555555","edited":false},"group-backgroundColor":{"value":"#333333","edited":false},"widget-textColor":{"value":"#eeeeee","edited":false},"widget-backgroundColor":{"value":"#097479","edited":false},"widget-borderColor":{"value":"#333333","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Home Pi","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"ff59f912.c74c18","type":"ui_group","name":"Weather","tab":"1ccd01c9.17d2ae","order":1,"disp":false,"width":"20","collapse":false},{"id":"1ccd01c9.17d2ae","type":"ui_tab","name":"Weather","icon":"dashboard","order":2,"disabled":false,"hidden":false},{"id":"8c3cb8b0.2c1968","type":"position-config","name":"Current Day","isValide":"true","longitude":"0","latitude":"0","angleType":"deg","timeZoneOffset":"99","timeZoneDST":"0","stateTimeFormat":"3","stateDateFormat":"12"},{"id":"7ef9b293.d5bb5c","type":"ui_spacer","name":"spacer","group":"ff59f912.c74c18","order":1,"width":"20","height":1},{"id":"a6969878.e2b0f8","type":"ui_spacer","name":"spacer","group":"ff59f912.c74c18","order":2,"width":"2","height":"5"},{"id":"bf02f4ff.43b4b8","type":"ui_spacer","name":"spacer","group":"ff59f912.c74c18","order":4,"width":"2","height":"5"},{"id":"1e1c880c.ba6698","type":"ui_spacer","name":"spacer","group":"ff59f912.c74c18","order":6,"width":"8","height":1},{"id":"477615d5.b2708c","type":"ui_spacer","name":"spacer","group":"ff59f912.c74c18","order":8,"width":"8","height":1},{"id":"e8511a5b.67fed8","type":"ui_spacer","name":"spacer","group":"ff59f912.c74c18","order":10,"width":"8","height":1},{"id":"4efa5e26.baad9","type":"ui_spacer","name":"spacer","group":"ff59f912.c74c18","order":12,"width":"8","height":1},{"id":"ddb40248.63d95","type":"ui_spacer","name":"spacer","group":"ff59f912.c74c18","order":14,"width":"6","height":1},{"id":"7af51dc9.c01ea4","type":"ui_spacer","name":"spacer","group":"ff59f912.c74c18","order":15,"width":"20","height":1},{"id":"8dc21fdf.2aa38","type":"ui_spacer","name":"spacer","group":"ff59f912.c74c18","order":17,"width":"20","height":1},{"id":"e936e092.331ce","type":"ui_spacer","name":"spacer","group":"ff59f912.c74c18","order":19,"width":"20","height":1},{"id":"351431f3.12e9ee","type":"ui_group","name":"Sensor Data","tab":"172cc7b9.88ddf8","order":2,"disp":false,"width":"20","collapse":false},{"id":"172cc7b9.88ddf8","type":"ui_tab","name":"Environment","icon":"dashboard","order":1,"disabled":false,"hidden":false},{"id":"f0f2a938.972238","type":"ui_group","name":"Board Data","tab":"e0dedd27.1df22","order":1,"disp":false,"width":"10","collapse":false},{"id":"e0dedd27.1df22","type":"ui_tab","name":"Raspberry Pi","icon":"dashboard","order":3,"disabled":false,"hidden":false},{"id":"8ca76791.261c98","type":"ui_spacer","name":"spacer","group":"351431f3.12e9ee","order":10,"width":"20","height":1},{"id":"6c1cbda2.4a9334","type":"ui_spacer","name":"spacer","group":"351431f3.12e9ee","order":6,"width":"20","height":1},{"id":"c01580f9.1f734","type":"pi-hole-config","url":"192.168.1.120:80","name":"PiHole","auth":"118c754632b13c4ba05fa9d1255fde83d920fe9147ef3d6f13219eb9ccca2fc9","https":false},{"id":"212b7f06.b4731","type":"ui_group","name":"Gauge","tab":"","order":2,"disp":true,"width":"6"},{"id":"49924182.27202","type":"alexa-home-conf","username":"hardillb"},{"id":"66dcfd93.3b4cc4","type":"telegram command","z":"d6cb01d2.47662","name":"","command":"/help","bot":"","strict":false,"hasresponse":true,"x":210,"y":120,"wires":[["738aaaff.8f3a64","9c1ad1c5.0e355"],[]]},{"id":"39db90c6.3809b","type":"telegram sender","z":"d6cb01d2.47662","name":"","bot":"","x":1230,"y":520,"wires":[[]]},{"id":"738aaaff.8f3a64","type":"function","z":"d6cb01d2.47662","name":"Help","func":"var Message = \"Ich bin der AXBot\\n\\nMeine Befehlliste:\\n\";\nMessage += \"/getid -> Erhalte deine eigene Id\\n\";\nMessage += \"/server -> Erhalten den Server Status\\n\";\nMessage += \"/getsharedata -> Aktienkurs\\n\";\nMessage += \"/shutdownbot -> Schalte den Bot aus\\n\";\nMessage += \"/setclockcolor -> Wanduhr Farbe umstellen\\n\";\nMessage += \"/setclockbrightness -> Wanduhr Helligkeit umstellen\\n\";\n\nmsg.payload.content = Message;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":430,"y":120,"wires":[["39db90c6.3809b"]]},{"id":"e9893a57.2b8a38","type":"telegram command","z":"d6cb01d2.47662","name":"","command":"/getid","bot":"","strict":false,"hasresponse":true,"x":210,"y":220,"wires":[["ce7ca39b.aa52b"],[]]},{"id":"ce7ca39b.aa52b","type":"function","z":"d6cb01d2.47662","name":"GetId","func":"var Message = \"Deine Id ist: \";\nMessage += msg.payload.chatId;\n\nmsg.payload.content = Message;\nreturn msg;","outputs":1,"noerr":0,"x":430,"y":220,"wires":[["39db90c6.3809b"]]},{"id":"ad568e06.d29a9","type":"telegram command","z":"d6cb01d2.47662","name":"","command":"/server","bot":"","strict":false,"hasresponse":true,"x":210,"y":320,"wires":[["53c3598.2efe3a8"],[]]},{"id":"53c3598.2efe3a8","type":"function","z":"d6cb01d2.47662","name":"Server","func":"/////////////////AXCloud\nvar AXWebPage = global.get('AXWebPage') || 0; // Get global variable\nvar Message = \"Webseite Status:\\n\";\nif (AXWebPage === true)\n{\n    Message += \"-Online\\n\\n\";\n}\nelse\n{\n    Message += \"-Offline ERROR!\\n\\n\";\n}\n\n/////////////////SmartHome\nvar SmartHomeOnline = global.get('SmartHomeOnline') || 0; // Get global variable\nMessage += \"Smart Home Status:\\n\";\nif (SmartHomeOnline === true)\n{\n    Message += \"-Online\\n\\n\";\n}\nelse\n{\n    Message += \"-Offline ERROR!\\n\\n\";\n}\n\n/////////////////Set Output message\nmsg.payload.content = Message;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":430,"y":320,"wires":[["39db90c6.3809b"]]},{"id":"114f9c20.ca3734","type":"ping","z":"d6cb01d2.47662","mode":"timed","name":"Ping SmartHome","host":"Your SmartHome IP","timer":"60","inputs":0,"x":1220,"y":320,"wires":[["e6cc6d27.eabb1"]]},{"id":"cbae487a.5d80b8","type":"function","z":"d6cb01d2.47662","name":"AXWebPage","func":"//Initialize global variable\nvar ServerOnline = global.get('AXWebPage') || {};\n\n//Check if server is online\nif (msg.payload === false)\n{\n    ServerOnline = false;\n}\nelse\n{\n    ServerOnline = true;\n}\n\n// Set global data\nglobal.set('AXWebPage', ServerOnline);","outputs":0,"noerr":0,"x":1470,"y":260,"wires":[]},{"id":"e6cc6d27.eabb1","type":"function","z":"d6cb01d2.47662","name":"SmartHome","func":"//Initialize global variable\nvar ServerOnline = global.get('SmartHomeOnline') || {};\n\n//Check if server is online\nif (msg.payload === false)\n{\n    ServerOnline = false;\n}\nelse\n{\n    ServerOnline = true;\n}\n\n// Set global data\nglobal.set('SmartHomeOnline', ServerOnline);","outputs":0,"noerr":0,"x":1470,"y":320,"wires":[]},{"id":"b5eb0227.c1765","type":"telegram command","z":"d6cb01d2.47662","name":"","command":"/shutdownbot","bot":"","strict":false,"hasresponse":true,"x":230,"y":720,"wires":[["540d9c35.c21684"],[]]},{"id":"540d9c35.c21684","type":"function","z":"d6cb01d2.47662","name":"ShutdownBot","func":"//Initialize global variable\nvar ShutdownCounter = global.get('ShutdownCounter') || 0;\nvar Message;\nvar ShutdownCmd = false;\n\nif (ShutdownCounter === 0)\n{\n    ShutdownCounter += 1;\n    Message = \"Bot abschalten -> Sind Sie sicher?\";\n}\nelse if (ShutdownCounter === 1)\n{\n    ShutdownCounter += 1;\n    Message = \"ABSOLUT SICHER???\";\n}\nelse if (ShutdownCounter >= 2)\n{\n    ShutdownCounter = 0;\n    ShutdownCmd = true;\n    Message = \"Bot schaltet sich aus -> Bye bye\";\n}\n\n// Set global data\nglobal.set('ShutdownCounter', ShutdownCounter);\n\n// Set output message\nmsg.payload.content = Message;\nvar msg2 = {payload:ShutdownCmd};\nreturn [msg,msg2];","outputs":2,"noerr":0,"initialize":"","finalize":"","libs":[],"x":450,"y":720,"wires":[["39db90c6.3809b"],["c8307377.df136"]]},{"id":"c8307377.df136","type":"shutdown","z":"d6cb01d2.47662","name":"","x":700,"y":720,"wires":[]},{"id":"d2610b83.876738","type":"inject","z":"d6cb01d2.47662","name":"AutoDailyCmd","repeat":"","crontab":"10 12 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"{\"chatId\":\"135889873\",\"type\":\"message\",\"content\":\"\"}","payloadType":"json","x":240,"y":420,"wires":[["341fe9a9.95c136","53c3598.2efe3a8"]]},{"id":"341fe9a9.95c136","type":"function","z":"d6cb01d2.47662","name":"Reset ShutdownCounter","func":"//Reset Shutdowncounter\nvar ShutdownCounter = 0;\nglobal.set('ShutdownCounter', ShutdownCounter);\n","outputs":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":490,"y":420,"wires":[]},{"id":"be4c591a.3b94e8","type":"telegram command","z":"d6cb01d2.47662","name":"","command":"/setclockbrightness","bot":"","strict":false,"hasresponse":true,"x":250,"y":520,"wires":[["487e8f11.b8dd"],[]]},{"id":"487e8f11.b8dd","type":"function","z":"d6cb01d2.47662","name":"SetClockBrightness","func":"//Initialize keyboard\ncontext.global.keyboard1 = {pending : true};\ncontext.global.keyboard2 = {pending : false};\n\n//Set keyboard button\nvar opts = {\n    reply_markup: JSON.stringify({\n        \"inline_keyboard\": [[\n            {\n                \"text\" : \"0\",\n                \"callback_data\": \"Br0\"\n            },\n            {\n                \"text\": \"+10\",\n                \"callback_data\" : \"Br+10\"\n            },\n            {\n                \"text\": \"+50\",\n                \"callback_data\" : \"Br+50\"\n            },\n            {\n                \"text\": \"-10\",\n                \"callback_data\" : \"Br-10\"\n            },\n            {\n                \"text\": \"-50\",\n                \"callback_data\" : \"Br-50\"\n            },\n            {\n                \"text\": \"100\",\n                \"callback_data\" : \"Br100\"\n            }\n            ]\n        ]\n    })\n};\n\n//Set output message\nvar reply = \"Waehle die Helligkeit der Uhr:\"\nmsg.payload = {chatId : msg.payload.chatId, type : 'message', content : reply, options : opts}\nreturn [ msg ];","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":470,"y":520,"wires":[["39db90c6.3809b"]]},{"id":"4d3f034c.8f1fec","type":"telegram command","z":"d6cb01d2.47662","name":"","command":"/setclockcolor","bot":"","strict":false,"hasresponse":true,"x":230,"y":620,"wires":[["6af640a6.0a653"],[]]},{"id":"6af640a6.0a653","type":"function","z":"d6cb01d2.47662","name":"SetClockColor","func":"//Initialize keyboard\ncontext.global.keyboard2 = { pending : true };\ncontext.global.keyboard1 = { pending : false };\n\n//Set keyboard button\nvar opts = {\n    reply_markup: JSON.stringify({\n        \"inline_keyboard\": [[\n            //Green\n            {\n                \"text\" : \"G+\",\n                \"callback_data\": \"G+10\"\n            },\n            {\n                \"text\": \"G-\",\n                \"callback_data\" : \"G-10\"\n            },\n            \n            //Red\n            {\n                \"text\" : \"R+\",\n                \"callback_data\": \"R+10\"\n            },\n            {\n                \"text\": \"R-\",\n                \"callback_data\" : \"R-10\"\n            },\n            \n            //Blue\n            {\n                \"text\" : \"B+\",\n                \"callback_data\": \"B+10\"\n            },\n            {\n                \"text\": \"B-\",\n                \"callback_data\" : \"B-10\"\n            },\n            \n            //On\n            {\n                \"text\" : \"On\",\n                \"callback_data\": \"On\"\n            },\n            \n            //Off\n            {\n                \"text\" : \"Off\",\n                \"callback_data\": \"Off\"\n            }\n            ]\n        ]\n    })\n};\n\n//Set output message\nvar reply = \"Setze die Uhr Farbe:\"\nmsg.payload = {chatId : msg.payload.chatId, type : 'message', content : reply, options : opts}\nreturn [ msg ];","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":460,"y":620,"wires":[["39db90c6.3809b"]]},{"id":"486b5ef9.1a1a8","type":"telegram event","z":"d6cb01d2.47662","name":"","bot":"","event":"callback_query","autoanswer":false,"x":220,"y":1060,"wires":[["28b95ce8.bfa724"]]},{"id":"28b95ce8.bfa724","type":"function","z":"d6cb01d2.47662","name":"Save answer data","func":"//Initialize global variable\nvar ClockBrightness = global.get('ClockBrightness');\nvar ClockGreen = global.get('ClockGreen');\nvar ClockRed = global.get('ClockRed');\nvar ClockBlue = global.get('ClockBlue');\nvar ClockOn = global.get('ClockOn');\n\n//Check if global variable is undefined\nif ((ClockGreen !== undefined) &&\n    (ClockRed !== undefined) &&\n    (ClockBlue !== undefined) &&\n    (ClockBrightness !== undefined) &&\n    (ClockOn !== undefined))\n{\n    //Distribut content\n    switch (msg.payload.content) \n    {\n        ////Brightness\n        case \"Br0\":\n            ClockBrightness = 0;\n            break;\n        case \"Br+10\":\n            ClockBrightness = parseInt(ClockBrightness);\n            \n            ClockBrightness += 10;\n            \n            //Check limit\n            if (ClockBrightness >= 100)\n            {\n                ClockBrightness = 100;\n            }\n            break;\n        case \"Br+50\":\n            ClockBrightness = parseInt(ClockBrightness);\n            \n            ClockBrightness += 50;\n            \n            //Check limit\n            if (ClockBrightness >= 100)\n            {\n                ClockBrightness = 100;\n            }\n            break;\n        case \"Br-10\":\n            ClockBrightness = parseInt(ClockBrightness);\n            \n            ClockBrightness -= 10;\n            \n            //Check limit\n            if (ClockBrightness <= 0)\n            {\n                ClockBrightness = 0;\n            }\n            break;\n        case \"Br-50\":\n            ClockBrightness = parseInt(ClockBrightness);\n            \n            ClockBrightness -= 50;\n            \n            //Check limit\n            if (ClockBrightness <= 0)\n            {\n                ClockBrightness = 0;\n            }\n            break;\n        case \"Br100\":\n            ClockBrightness = 100;\n            break;\n            \n        ////Color\n        case \"G+10\":\n            ClockGreen = parseInt(ClockGreen);\n            \n            ClockGreen += 10;\n            \n            //Check limit\n            if (ClockGreen >= 255)\n            {\n                ClockGreen = 255;\n            }\n            break;\n            \n        case \"G-10\":\n            ClockGreen = parseInt(ClockGreen);\n            \n            ClockGreen -= 10;\n            \n            //Check limit\n            if (ClockGreen <= 0)\n            {\n                ClockGreen = 0;\n            }\n            break;\n            \n        case \"R+10\":\n            ClockRed = parseInt(ClockRed);\n            \n            ClockRed += 10;\n            \n            //Check limit\n            if (ClockRed >= 255)\n            {\n                ClockRed = 255;\n            }\n            break;\n            \n        case \"R-10\":\n            ClockRed = parseInt(ClockRed);\n            \n            ClockRed -= 10;\n            \n            //Check limit\n            if (ClockRed <= 0)\n            {\n                ClockRed = 0;\n            }\n            break;\n            \n        case \"B+10\":\n            ClockBlue = parseInt(ClockBlue);\n            \n            ClockBlue += 10;\n            \n            //Check limit\n            if (ClockBlue >= 255)\n            {\n                ClockBlue = 255;\n            }\n            break;\n            \n        case \"B-10\":\n            ClockBlue = parseInt(ClockBlue);\n            \n            ClockBlue -= 10;\n            \n            //Check limit\n            if (ClockBlue <= 0)\n            {\n                ClockBlue = 0;\n            }\n            break;\n            \n        //// On\n        case \"On\":\n            ClockOn = 2;\n            break;\n            \n        //// Off\n        case \"Off\":\n            ClockOn = 3;\n            break;\n            \n        default:\n            break;\n    }\n    \n    //Set global variable\n    global.set('ClockBrightness', ClockBrightness);\n    global.set('ClockGreen', ClockGreen);\n    global.set('ClockRed', ClockRed);\n    global.set('ClockBlue', ClockBlue);\n    global.set('ClockOn', ClockOn);\n}","outputs":0,"noerr":0,"x":470,"y":1060,"wires":[]},{"id":"6fe769a3.ae9438","type":"inject","z":"d9a38654.e281d8","name":"","repeat":"1","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"num","x":170,"y":320,"wires":[["e4091d0c.3a7f7"]]},{"id":"f8b07e20.a2ca1","type":"function","z":"7098b56.4a13c4c","name":"simpletime","func":"var ts = msg.timestamp || Date.now();\nvar d = new Date(ts);\ndt = d.toDateString();\ne = d.getTime();\n\nvar a = d.toJSON().split(/\\D+/);\nvar h = a[3];\nvar m = a[4];\nvar s = a[5];\n\nvar tm = (h+\":\"+m);\nvar tms = (h+\":\"+m+\":\"+s);\nvar ms = (m+\":\"+s);\nmsg.myrawdate = d;\nmsg.myepoch = e;\nmsg.mysecond = s;\nmsg.myminute = m;\nmsg.myminutes = ms;\nmsg.myhour = h;\nmsg.mytime = tm;\nmsg.mytimes = tms;\nmsg.mydate = dt;\n\nreturn msg;","outputs":1,"noerr":0,"x":311,"y":108,"wires":[[]]},{"id":"619efa49.0f2f24","type":"file","z":"d9a38654.e281d8","name":"Clock Colour","filename":"/home/pi/ClockColour.txt","appendNewline":true,"createDir":true,"overwriteFile":"true","encoding":"none","x":630,"y":320,"wires":[[]]},{"id":"e4091d0c.3a7f7","type":"function","z":"d9a38654.e281d8","name":"Clock Colour","func":"//Initialize global variable\nvar ClockBrightness = global.get('ClockBrightness');\nvar ClockGreen = global.get('ClockGreen');\nvar ClockRed = global.get('ClockRed');\nvar ClockBlue = global.get('ClockBlue');\nvar ClockOn = global.get('ClockOn');\nvar UpdateClockMinOld = global.get('UpdateClockMinOld');\n\n// Old global variable for compare\nvar ClockBrightnessOld = global.get('ClockBrightnessOld');\nvar ClockGreenOld = global.get('ClockGreenOld');\nvar ClockRedOld = global.get('ClockRedOld');\nvar ClockBlueOld = global.get('ClockBlueOld');\nvar ClockOnOld = global.get('ClockOnOld');\n\n//Get actual time\nvar ActTimestamp = Date.now();\nvar ActDate = new Date(ActTimestamp);\nvar ActMin = ActDate.getMinutes();\nvar ActHour = ActDate.getHours();\nvar ActTime = ActDate.toLocaleTimeString();\n\n//Sleep time\nif ((ActHour === 1) && (ActMin === 1))\n{\n    ClockOn = 3; //Off\n    global.set('ClockOn', ClockOn);\n}\nelse if ((ActHour === 5) && (ActMin === 1))\n{\n    ClockOn = 2; //On\n    global.set('ClockOn', ClockOn);\n}\n\n//Modifie string\nvar Message\n\n//Check if global variable is undefined\nif ((ClockGreen !== undefined) &&\n    (ClockRed !== undefined) &&\n    (ClockBlue !== undefined) &&\n    (ClockBrightness !== undefined) &&\n    (ClockOn !== undefined))\n{\n    Message = ClockGreen + \",\" + ClockRed + \",\" + ClockBlue + \",\" + ClockBrightness + \",\";\n    \n    if (ClockOn == 2)\n    {\n        Message += \"1\"; //On\n    }\n    else\n    {\n        Message += \"0\"; //Off\n    }\n}\nelse //Global data not defined\n{\n    Message = \"0,0,50,100,1\";\n    \n    ClockGreen = 0;\n    ClockRed = 0;\n    ClockBlue = 50;\n    ClockBrightness = 100;\n    ClockOn = 2;\n}\n\n//Check if clock has to be updatet\nif ((ClockBrightnessOld > ClockBrightness) || (ClockBrightnessOld < ClockBrightness) ||\n    (ClockGreenOld > ClockGreen) || (ClockGreenOld < ClockGreen) ||\n    (ClockRedOld > ClockRed) || (ClockRedOld < ClockRed) ||\n    (ClockBlueOld > ClockBlue) || (ClockBlueOld < ClockBlue) ||\n    (ClockOnOld > ClockOn) || (ClockOnOld < ClockOn))\n{\n    // Update global variable\n    global.set('UpdateClockMinOld', ActMin);\n    global.set('ClockBrightnessOld', ClockBrightness);\n    global.set('ClockGreenOld', ClockGreen);\n    global.set('ClockRedOld', ClockRed);\n    global.set('ClockBlueOld', ClockBlue);\n    global.set('ClockOnOld', ClockOn);\n\n    //Set output message\n    msg.payload = Message;\n    return msg; \n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":390,"y":320,"wires":[["619efa49.0f2f24","82ce426a.e161a"]]},{"id":"e408a69c.d042b8","type":"inject","z":"d9a38654.e281d8","name":"","repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"num","x":160,"y":220,"wires":[["ec49e482.e6a0d8"]]},{"id":"68b4b166.6b106","type":"function","z":"d9a38654.e281d8","name":"Generate global data","func":"////Split string in to main parts\nvar strMainArray = msg.payload.split(\",\");\n\n////Information: Green\nvar Green = strMainArray[0];\nif(Green !== \"\")\n{\n    global.set('ClockGreen', Green);\n}\nelse\n{\n    global.set('ClockGreen', 15);\n}\n\n////Information: Red\nvar Red = strMainArray[1];\nif(Red !== \"\")\n{\n    global.set('ClockRed', Red);\n}\nelse\n{\n    global.set('ClockRed', 15);\n}\n\n////Information: Blue\nvar Blue = strMainArray[2];\nif(Blue !== \"\")\n{\n    global.set('ClockBlue', Blue);\n}\nelse\n{\n    global.set('ClockBlue', 15);\n}\n\n////Information: Brightness\nvar Brightness = strMainArray[3];\nif(Brightness !== \"\")\n{\n    global.set('ClockBrightness', Brightness);\n}\nelse\n{\n    global.set('ClockBrightness', 15);\n}\n\n////Information: On\nvar ClockOn = strMainArray[4];\nif(ClockOn !== \"\")\n{\n    if (ClockOn > 0)\n    {\n        ClockOn = 2; //On\n    }\n    else\n    {\n        ClockOn = 3; //Off\n    }\n}\nelse\n{\n    ClockOn = 2; //On\n}\n\nglobal.set('ClockOn', ClockOn);\n\n////Set old global data\nglobal.set('ClockBrightnessOld', 0);\nglobal.set('ClockGreenOld', 0);\nglobal.set('ClockRedOld', 0);\nglobal.set('ClockBlueOld', 0);\nglobal.set('ClockOnOld', 0);\n","outputs":0,"noerr":0,"x":660,"y":220,"wires":[]},{"id":"ec49e482.e6a0d8","type":"file in","z":"d9a38654.e281d8","name":"Clock Colour","filename":"/home/pi/ClockColour.txt","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":390,"y":220,"wires":[["68b4b166.6b106"]]},{"id":"82ce426a.e161a","type":"file","z":"d9a38654.e281d8","name":"Colour Logger","filename":"/home/pi/LoggerColour.txt","appendNewline":true,"createDir":false,"overwriteFile":"false","encoding":"none","x":640,"y":420,"wires":[[]]},{"id":"759c8dbc.bc4404","type":"inject","z":"d6cb01d2.47662","name":"","repeat":"","crontab":"","once":true,"onceDelay":"2","topic":"","payload":"","payloadType":"num","x":240,"y":1140,"wires":[["28b95ce8.bfa724"]]},{"id":"33d03adf.5930b6","type":"exec","z":"d6cb01d2.47662","command":"python3 axdegiro.py","addpay":true,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"Run share handler script","x":270,"y":900,"wires":[["d11d2552.33d298","ae6c7911.21d908"],[],[]]},{"id":"be6011b8.afd49","type":"telegram command","z":"d6cb01d2.47662","name":"","command":"/getsharedata","bot":"","strict":false,"hasresponse":true,"x":230,"y":820,"wires":[["33d03adf.5930b6"],[]]},{"id":"ae6c7911.21d908","type":"file in","z":"d6cb01d2.47662","name":"Get share data","filename":"ax_share.txt","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":500,"y":900,"wires":[["d153f413.bfe9c8"]]},{"id":"d153f413.bfe9c8","type":"change","z":"d6cb01d2.47662","name":"Convert data","rules":[{"t":"move","p":"payload","pt":"msg","to":"payload.content","tot":"msg"},{"t":"set","p":"payload.chatId","pt":"msg","to":"135889873","tot":"num"},{"t":"set","p":"payload.messageId","pt":"msg","to":"2294","tot":"num"},{"t":"set","p":"payload.type","pt":"msg","to":"message","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":690,"y":900,"wires":[["39db90c6.3809b"]]},{"id":"1e69ba46.dcb3f6","type":"inject","z":"d6cb01d2.47662","name":"AutoDailyCmd","repeat":"","crontab":"30 18 * * 1,2,3,4,5","once":false,"onceDelay":0.1,"topic":"","payload":"{\"chatId\":\"135889873\",\"type\":\"message\",\"content\":\"\"}","payloadType":"json","x":240,"y":980,"wires":[["33d03adf.5930b6"]]},{"id":"edf1edb3.0f905","type":"is online","z":"d6cb01d2.47662","name":"AXWebPage Check","url":"alexmerz.ch","action":"0","x":1230,"y":260,"wires":[["cbae487a.5d80b8"]]},{"id":"3144939b.254ebc","type":"inject","z":"d6cb01d2.47662","name":"Intervall Check","repeat":"60","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1000,"y":260,"wires":[["edf1edb3.0f905"]]},{"id":"ee6c701c.0385a","type":"ui_text","z":"78ecb57.5c40b4c","group":"ff59f912.c74c18","order":13,"width":5,"height":1,"name":"WeatherDescription","label":"","format":"{{msg.payload.current.weather[0].description}}","layout":"row-left","x":1450,"y":120,"wires":[]},{"id":"de7cde59.dd30e","type":"ui_text","z":"78ecb57.5c40b4c","group":"ff59f912.c74c18","order":7,"width":"3","height":1,"name":"Wind","label":"","format":"{{msg.payload.current.wind_speed}}&nbsp;&nbsp;<i class=\"wi wi-darksky-wind\"></i>&nbsp;&nbsp;{{msg.payload.current.wind_cardinal}}","layout":"col-center","x":1410,"y":200,"wires":[]},{"id":"b66821.955767e","type":"ui_text","z":"78ecb57.5c40b4c","group":"ff59f912.c74c18","order":9,"width":"3","height":1,"name":"SunriseTime","label":"","format":"<i class=\"wi wi-owm-01d\"></i>&nbsp;<i class=\"fa fa-arrow-up\"></i>&nbsp;&nbsp;{{msg.payload.current.sunrise}}","layout":"row-center","x":1430,"y":240,"wires":[]},{"id":"300059ac.386146","type":"ui_text","z":"78ecb57.5c40b4c","group":"ff59f912.c74c18","order":11,"width":"3","height":1,"name":"SunsetTime","label":"","format":"<i class=\"wi wi-wu-sunny\"></i>&nbsp;<i class=\"fa fa-arrow-down\"></i>&nbsp;&nbsp;{{msg.payload.current.sunset}}","layout":"row-center","x":1430,"y":280,"wires":[]},{"id":"c54923ec.38cb4","type":"ui_template","z":"78ecb57.5c40b4c","group":"ff59f912.c74c18","name":"WeatherDayForecast","order":18,"width":"20","height":"3","format":"<div style=\"height: 100%; justify-content: center; align-items: center;\">\n <div layout=\"rowicons\" layout-align=\"space-around start\" ng-repeat=\"data in msg.payload.rowicons\" style=\"font-size:250%;padding-top: 5px;padding-bottom: 5px\">\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell01}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell02}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell03}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell04}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell05}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell06}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell07}}\"></i></span>\n </div>\n <div layout=\"rowtext\" layout-align=\"space-around start\" ng-repeat=\"data in msg.payload.rowtext\" style=\"line-height: 250%\">\n  <span flex style=\"color: white;text-align: center;\">{{data.cell01}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell02}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell03}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell04}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell05}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell06}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell07}}</span>\n </div>\n</div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":1460,"y":520,"wires":[[]]},{"id":"7b4cab1c.900ae4","type":"ui_text","z":"78ecb57.5c40b4c","group":"ff59f912.c74c18","order":5,"width":"3","height":1,"name":"Temperature","label":"","format":"<p style=\"font-size: 200%\">{{msg.payload.current.temp}}</p>","layout":"row-left","x":1430,"y":160,"wires":[]},{"id":"7cbdd985.f35ef8","type":"http request","z":"78ecb57.5c40b4c","name":"Get online weather data","method":"GET","ret":"obj","paytoqs":"query","url":"https://api.openweathermap.org/data/2.5/onecall","tls":"","persist":false,"proxy":"","authType":"","x":790,"y":220,"wires":[["5c8dde1d.b5afa","207d5ccd.3dd374","7c5ef1a8.9d32f","ee5b6765.036ca8"]]},{"id":"2eb93053.61c92","type":"inject","z":"78ecb57.5c40b4c","name":"Trigger Slow","repeat":"1200","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":300,"y":220,"wires":[["9c6da3dd.167b9","e291e5fb.f44d78"]]},{"id":"5c8dde1d.b5afa","type":"function","z":"78ecb57.5c40b4c","name":"Current weather data","func":"var icon = {};\n\n//// Timehandling\nfunction timeConvert(UNIX_timestamp)\n{\n  var a = new Date(UNIX_timestamp * 1000);\n  var hour = a.getHours();\n  var suffix = \" am\";\n  if (hour >= 12) {\n    hour = hour - 12;\n    suffix = \" pm\";\n  }\n  if (hour === 0) {\n    hour = 12;\n  }\n  var min = a.getMinutes();\n  if (min < 10) {min = \"0\" + min;}\n  return hour + ':' + min + suffix;\n}\n\n//// Wind direction\nvar degreesToCardinal = function(deg){\nif (deg>11.25 && deg<=33.75){\nreturn \"NNE\";\n  }else if (deg>33.75 && deg<56.25){\nreturn \"NE\";\n  }else if (deg>56.25 && deg<78.75){\nreturn \"ENE\";\n  }else if (deg>78.75 && deg<101.25){\nreturn \"E\";\n  }else if (deg>101.25 && deg<123.75){\nreturn \"ESE\";\n  }else if (deg>123.75 && deg<146.25){\nreturn \"SE\";\n  }else if (deg>146.25 && deg<168.75){\nreturn \"SSE\";\n  }else if (deg>168.75 && deg<191.25){\nreturn \"S\";\n  }else if (deg>191.25 && deg<213.75){\nreturn \"SSW\";\n  }else if (deg>213.75 && deg<236.25){\nreturn \"SW\";\n  }else if (deg>236.25 && deg<258.75){\nreturn \"WSW\";\n  }else if (deg>258.75 && deg<281.25){\nreturn \"W\";\n  }else if (deg>281.25 && deg<303.75){\nreturn \"WNW\";\n  }else if (deg>303.75 && deg<326.25){\nreturn \"NW\";\n  }else if (deg>326.25 && deg<348.75){\nreturn \"NNW\";\n  }else{\nreturn \"N\"; \n  }\n}\n\n//// Set data for widget\nmsg.payload.current.temp = msg.payload.current.temp.toFixed(1) + ' Â°C';\nmsg.payload.current.wind_speed = msg.payload.current.wind_speed.toFixed(1) + ' m/s';\nmsg.payload.current.wind_cardinal = degreesToCardinal(msg.payload.current.wind_deg);\nmsg.payload.current.sunrise = timeConvert(msg.payload.current.sunrise);\nmsg.payload.current.sunset = timeConvert(msg.payload.current.sunset);\n\n//// Current weather icon\nvar iconString = 'wi-owm-' + msg.payload.current.weather[0].icon + ' wi-10x';\nicon = {\n    ui_control: {\n        icon: iconString\n    }\n}; \n\n//// Output\nreturn [msg, icon];","outputs":2,"noerr":0,"x":1140,"y":220,"wires":[["7b4cab1c.900ae4","de7cde59.dd30e","ee6c701c.0385a","b66821.955767e","300059ac.386146"],["ce7d661d.6c79a8"]]},{"id":"9c6da3dd.167b9","type":"change","z":"78ecb57.5c40b4c","name":"Set location, appid, units","rules":[{"t":"delete","p":"payload","pt":"msg"},{"t":"set","p":"payload.lat","pt":"msg","to":"47.347431","tot":"str"},{"t":"set","p":"payload.lon","pt":"msg","to":"8.70088","tot":"str"},{"t":"set","p":"payload.appid","pt":"msg","to":"Your appid","tot":"str"},{"t":"set","p":"payload.units","pt":"msg","to":"metric","tot":"str"},{"t":"set","p":"units","pt":"flow","to":"payload.units","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":530,"y":220,"wires":[["7cbdd985.f35ef8"]]},{"id":"ce7d661d.6c79a8","type":"ui_button","z":"78ecb57.5c40b4c","name":"CurrentIcon","group":"ff59f912.c74c18","order":3,"width":"5","height":"5","passthru":false,"label":"","tooltip":"","color":"","bgcolor":"","icon":"fa-refresh fa-4x","payload":"true","payloadType":"bool","topic":"","x":1430,"y":320,"wires":[[]]},{"id":"882f31b4.f78b6","type":"ui_template","z":"78ecb57.5c40b4c","group":"ff59f912.c74c18","name":"CurrentWeatherTimeline","order":16,"width":"20","height":"3","format":"<div style=\"height: 100%; justify-content: center; align-items: center;\">\n <div layout=\"rowicons\" layout-align=\"space-around start\" ng-repeat=\"data in msg.payload.rowicons\" style=\"font-size:250%;padding-top: 5px;padding-bottom: 5px\">\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell01}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell02}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell03}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell04}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell05}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell06}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell07}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell08}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell09}}\"></i></span>\n  <span flex style=\"color: white;text-align: center\"><i class=\"wi wi-owm-{{data.cell10}}\"></i></span>\n </div>\n <div layout=\"rowtext\" layout-align=\"space-around start\" ng-repeat=\"data in msg.payload.rowtext\" style=\"line-height: 250%\">\n  <span flex style=\"color: white;text-align: center;\">{{data.cell01}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell02}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell03}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell04}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell05}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell06}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell07}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell08}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell09}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell10}}</span>\n </div>\n</div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":1470,"y":420,"wires":[[]]},{"id":"207d5ccd.3dd374","type":"function","z":"78ecb57.5c40b4c","name":"Current weather timeline","func":"var fcdata = {};\n\n//// Set max/min temprature -> Forecast\nfunction formatTemp(high, low)\n{\n    temp = parseFloat(high).toFixed() + 'Â°C'\n    return temp;\n}\n\n//// Set time of expected weather\nfunction timeConvert(UNIX_timestamp)\n{\n  var a = new Date(UNIX_timestamp * 1000);\n  var hour = a.getHours();\n  var suffix = \" am\";\n  if (hour >= 12) {\n    hour = hour - 12;\n    suffix = \" pm\";\n  }\n  if (hour === 0) {\n    hour = 12;\n  }\n  var min = a.getMinutes();\n  if (min < 10) {min = \"0\" + min;}\n//  return hour + ':' + min + suffix;\n  return hour + suffix;\n}\n\n//// Generate datastructure (CSS (Icon)/Time/Temperature)\nfcdata.payload = {\n  rowtext: {\n  \tdata01: {\n      cell01: timeConvert(msg.payload.hourly[1].dt),\n      cell02: timeConvert(msg.payload.hourly[2].dt),\n      cell03: timeConvert(msg.payload.hourly[3].dt),\n      cell04: timeConvert(msg.payload.hourly[4].dt),\n      cell05: timeConvert(msg.payload.hourly[5].dt),\n      cell06: timeConvert(msg.payload.hourly[6].dt),\n      cell07: timeConvert(msg.payload.hourly[7].dt),\n      cell08: timeConvert(msg.payload.hourly[8].dt),\n      cell09: timeConvert(msg.payload.hourly[9].dt),\n      cell10: timeConvert(msg.payload.hourly[10].dt),\n  \t},\n  \tdata02: {\n       cell01: formatTemp(msg.payload.hourly[1].temp),\n       cell02: formatTemp(msg.payload.hourly[2].temp),\n       cell03: formatTemp(msg.payload.hourly[3].temp),\n       cell04: formatTemp(msg.payload.hourly[4].temp),\n       cell05: formatTemp(msg.payload.hourly[5].temp),\n       cell06: formatTemp(msg.payload.hourly[6].temp),\n       cell07: formatTemp(msg.payload.hourly[7].temp),\n       cell08: formatTemp(msg.payload.hourly[8].temp),\n       cell09: formatTemp(msg.payload.hourly[9].temp),\n       cell10: formatTemp(msg.payload.hourly[10].temp),\n  \t}\n  },\n  rowicons: {\n  \tdata01: {\n  \t\tcell01: msg.payload.hourly[1].weather[0].icon,\n  \t\tcell02: msg.payload.hourly[2].weather[0].icon,\n  \t\tcell03: msg.payload.hourly[3].weather[0].icon,\n  \t\tcell04: msg.payload.hourly[4].weather[0].icon,\n  \t\tcell05: msg.payload.hourly[5].weather[0].icon,\n  \t\tcell06: msg.payload.hourly[6].weather[0].icon,\n  \t\tcell07: msg.payload.hourly[7].weather[0].icon,\n  \t\tcell08: msg.payload.hourly[8].weather[0].icon,\n  \t\tcell09: msg.payload.hourly[9].weather[0].icon,\n  \t\tcell10: msg.payload.hourly[10].weather[0].icon,\n  \t}\n  }\n}\n\nreturn fcdata;","outputs":1,"noerr":0,"x":1150,"y":420,"wires":[["882f31b4.f78b6"]]},{"id":"7c5ef1a8.9d32f","type":"function","z":"78ecb57.5c40b4c","name":"Weather forecast timeline","func":"var fcdata = {};\n\n//// Set max/min temprature\nfunction formatTemp(high, low)\n{\n    temp = parseFloat(high).toFixed() + '/' + parseFloat(low).toFixed() + 'Â°C'\n    return temp;\n}\n\n//// Set name of day\nfunction dayName(unixTime)\n{\n    var d = new Date(unixTime * 1000);\n    var weekday = new Array(7);\n        weekday[0] = \"Sun\";\n        weekday[1] = \"Mon\";\n        weekday[2] = \"Tue\";\n        weekday[3] = \"Wed\";\n        weekday[4] = \"Thu\";\n        weekday[5] = \"Fri\";\n        weekday[6] = \"Sat\";\n\n    return weekday[d.getDay()]\n}\n\n//// Generate datastructure (CSS (Icon)/Time/Temperature)\nfcdata.payload = {\n  rowtext: {\n  \tdata01: {\n      cell01: dayName(msg.payload.daily[1].dt),\n      cell02: dayName(msg.payload.daily[2].dt),\n      cell03: dayName(msg.payload.daily[3].dt),\n      cell04: dayName(msg.payload.daily[4].dt),\n      cell05: dayName(msg.payload.daily[5].dt),\n      cell06: dayName(msg.payload.daily[6].dt),\n      cell07: dayName(msg.payload.daily[7].dt),\n  \t},\n  \tdata02: {\n       cell01: formatTemp(msg.payload.daily[1].temp.max, msg.payload.daily[0].temp.min),\n       cell02: formatTemp(msg.payload.daily[2].temp.max, msg.payload.daily[0].temp.min),\n       cell03: formatTemp(msg.payload.daily[3].temp.max, msg.payload.daily[0].temp.min),\n       cell04: formatTemp(msg.payload.daily[4].temp.max, msg.payload.daily[0].temp.min),\n       cell05: formatTemp(msg.payload.daily[5].temp.max, msg.payload.daily[0].temp.min),\n       cell06: formatTemp(msg.payload.daily[6].temp.max, msg.payload.daily[0].temp.min),\n       cell07: formatTemp(msg.payload.daily[7].temp.max, msg.payload.daily[0].temp.min),\n  \t}\n  },\n  rowicons: {\n  \tdata01: {\n  \t\tcell01: msg.payload.daily[1].weather[0].icon,\n  \t\tcell02: msg.payload.daily[2].weather[0].icon,\n  \t\tcell03: msg.payload.daily[3].weather[0].icon,\n  \t\tcell04: msg.payload.daily[4].weather[0].icon,\n  \t\tcell05: msg.payload.daily[5].weather[0].icon,\n  \t\tcell06: msg.payload.daily[6].weather[0].icon,\n  \t\tcell07: msg.payload.daily[7].weather[0].icon,\n  \t}\n  }\n}\n\nreturn fcdata;","outputs":1,"noerr":0,"x":1150,"y":520,"wires":[["c54923ec.38cb4"]]},{"id":"ee5b6765.036ca8","type":"debug","z":"78ecb57.5c40b4c","d":true,"name":"Weather Debugger","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":1130,"y":140,"wires":[]},{"id":"9cfa2fb1.98cea","type":"ui_template","z":"78ecb57.5c40b4c","group":"ff59f912.c74c18","name":"MoonTimeline","order":20,"width":"20","height":"3","format":"<div style=\"height: 100%; justify-content: center; align-items: center;\">\n<div layout=\"rowicons\" layout-align=\"space-around start\" ng-repeat=\"data in msg.payload.rowicons\" style=\"font-size:250%;padding-top: 5px;padding-bottom: 5px\">\n  <font size=\"24px\">{{data.icon01}}</font>\n  <font size=\"24px\">{{data.icon02}}</font>\n  <font size=\"24px\">{{data.icon03}}</font>\n  <font size=\"24px\">{{data.icon04}}</font>\n  <font size=\"24px\">{{data.icon05}}</font>\n  <font size=\"24px\">{{data.icon06}}</font>\n  <font size=\"24px\">{{data.icon07}}</font>\n  <font size=\"24px\">{{data.icon08}}</font>\n </div>\n \n <div layout=\"rowtext\" layout-align=\"space-around start\" ng-repeat=\"data in msg.payload.rowtext\" style=\"line-height: 250%\">\n  <span flex style=\"color: white;text-align: center;\">{{data.cell01}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell02}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell03}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell04}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell05}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell06}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell07}}</span>\n  <span flex style=\"color: white;text-align: center\">{{data.cell08}}</span>\n </div>\n</div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":1440,"y":620,"wires":[[]]},{"id":"8380aa63.749968","type":"function","z":"78ecb57.5c40b4c","name":"Moon timeline","func":"//// Define icon\nvar arrayIconConst = [8];\narrayIconConst[1] = 'ðŸŒš';\narrayIconConst[2] = 'ðŸŒ’';\narrayIconConst[3] = 'ðŸŒ“';\narrayIconConst[4] = 'ðŸŒ”';\narrayIconConst[5] = 'ðŸŒ';\narrayIconConst[6] = 'ðŸŒ–';\narrayIconConst[7] = 'ðŸŒ—';\narrayIconConst[8] = 'ðŸŒ˜';\n\n\n//// Generate dataMatrix \nvar arrayIcon = [8];\n\n// Icon\narrayIcon[1] = msg.payload.illumination.phase.pos + 1; // Load icon -> watch position-config.js of node-red-contrib-sun-position\n\nfor (var i=2; i < 9; i++)\n{\n    arrayIcon[i] = arrayIcon[i-1] + 1; // Load icon -> watch position-config.js of node-red-contrib-sun-position\n    \n    // Check if max number was overcome\n    if (arrayIcon[i] > 8)\n    {\n        arrayIcon[i] = 1;\n    }\n}\n\n// Set date\nvar arrayDate = [8];\n\narrayDate[1] = 'Today';\narrayDate[2] = '+3 Days';\narrayDate[3] = '+7 Days';\narrayDate[4] = '+10 Days';\narrayDate[5] = '+15 Days';\narrayDate[6] = '+18 Days';\narrayDate[7] = '+22 Days';\narrayDate[8] = '+25 Days';\n\n\n//// Generate datastructure for output\nvar fcdata = {};\n\nfcdata.payload = {\n    rowtext: {\n  \tdata: {\n      cell01: arrayDate[1],\n      cell02: arrayDate[2],\n      cell03: arrayDate[3],\n      cell04: arrayDate[4],\n      cell05: arrayDate[5],\n      cell06: arrayDate[6],\n      cell07: arrayDate[7],\n      cell08: arrayDate[8],\n  \t}\n  },\n  rowicons: {\n  \tdata: {\n  \t\ticon01: arrayIconConst[arrayIcon[1]],\n  \t\ticon02: arrayIconConst[arrayIcon[2]],\n  \t\ticon03: arrayIconConst[arrayIcon[3]],\n  \t\ticon04: arrayIconConst[arrayIcon[4]],\n  \t\ticon05: arrayIconConst[arrayIcon[5]],\n  \t\ticon06: arrayIconConst[arrayIcon[6]],\n  \t\ticon07: arrayIconConst[arrayIcon[7]],\n  \t\ticon08: arrayIconConst[arrayIcon[8]],\n  \t}\n  }\n}\n\nreturn fcdata;","outputs":1,"noerr":0,"x":1120,"y":620,"wires":[["9cfa2fb1.98cea"]]},{"id":"e291e5fb.f44d78","type":"moon-position","z":"78ecb57.5c40b4c","name":"","positionConfig":"8c3cb8b0.2c1968","rules":[],"topic":"","outputs":1,"x":760,"y":620,"wires":[["8380aa63.749968"]]},{"id":"ae63632b.01468","type":"ui_chart","z":"98156df5.ec21f","name":"","group":"351431f3.12e9ee","order":3,"width":20,"height":3,"label":"Light [Lux]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"1000","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":1110,"y":300,"wires":[[]]},{"id":"83f7c275.ec7d1","type":"ui_chart","z":"98156df5.ec21f","name":"","group":"351431f3.12e9ee","order":4,"width":20,"height":3,"label":"Noise [dBA]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":1110,"y":360,"wires":[[]]},{"id":"326b4c40.cd8bc4","type":"ui_chart","z":"98156df5.ec21f","name":"","group":"351431f3.12e9ee","order":1,"width":20,"height":3,"label":"Temperature [Â°C]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":1130,"y":840,"wires":[[]]},{"id":"c9501cf1.d044d","type":"ui_chart","z":"98156df5.ec21f","name":"","group":"351431f3.12e9ee","order":2,"width":20,"height":3,"label":"Humidity [%]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":1110,"y":780,"wires":[[]]},{"id":"49da8766.797978","type":"ui_chart","z":"98156df5.ec21f","name":"","group":"351431f3.12e9ee","order":5,"width":20,"height":3,"label":"Pressure [KPa]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":1120,"y":420,"wires":[[]]},{"id":"41861b82.d7fa64","type":"ui_chart","z":"98156df5.ec21f","name":"","group":"351431f3.12e9ee","order":13,"width":20,"height":3,"label":"PM 2.5 [ug/m3]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":1120,"y":600,"wires":[[]]},{"id":"c0fe8791.834008","type":"ui_chart","z":"98156df5.ec21f","name":"","group":"351431f3.12e9ee","order":14,"width":20,"height":3,"label":"PM 10 [ug/m3]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":1120,"y":660,"wires":[[]]},{"id":"d29534a8.093b38","type":"ui_chart","z":"98156df5.ec21f","name":"","group":"351431f3.12e9ee","order":12,"width":20,"height":3,"label":"PM 1 [ug/m3]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":1110,"y":540,"wires":[[]]},{"id":"720a62b.8f1789c","type":"ui_chart","z":"98156df5.ec21f","name":"","group":"351431f3.12e9ee","order":8,"width":20,"height":3,"label":"eCO2 [ppm]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":1110,"y":180,"wires":[[]]},{"id":"41ce0d29.b61ce4","type":"ui_chart","z":"98156df5.ec21f","name":"","group":"351431f3.12e9ee","order":9,"width":20,"height":5,"label":"TVOC [ppb]","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":1110,"y":120,"wires":[[]]},{"id":"bdf979f6.71e9a8","type":"inject","z":"98156df5.ec21f","name":"","repeat":"1","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":190,"y":460,"wires":[["24dbdbb2.b4c6d4"]]},{"id":"24dbdbb2.b4c6d4","type":"http request","z":"98156df5.ec21f","name":"","method":"GET","ret":"txt","paytoqs":"ignore","url":"http://api.smartcitizen.me/v0/devices/13027","tls":"","persist":false,"proxy":"","authType":"","x":430,"y":460,"wires":[["df5e028d.1a7aa"]]},{"id":"df5e028d.1a7aa","type":"function","z":"98156df5.ec21f","name":"String-Distributor","func":"//// Split string in to main parts\nvar strMainArray = msg.payload.split(\"{\\\"id\\\":\");\nvar strSaveData;\n\n//// Split array into data parts\nvar strSensorInfo = strMainArray[1];\nvar strDeviceInfo = strMainArray[2];\nvar strLocationInfo = strMainArray[3];\nvar strTimeInfo = strMainArray[15];\n\n//// Organic compounds sensor\nvar strTVOC = strMainArray[4];\nvar intValuePos = strTVOC.indexOf(\"value\\\":\");\nintValuePos = intValuePos + 7; // remove value\":\nstrTVOC = strTVOC.substring(intValuePos, (intValuePos+8))\nintValuePos = strTVOC.indexOf(\",\\\"\");\nstrTVOC = strTVOC.substring(0, intValuePos)\nfloatTVOC = parseFloat(strTVOC);\nstrSaveData = \"TVOC;\" + strTVOC + \";end;\";\n\n//// Carbon dioxide sensor\nvar streCO2 = strMainArray[5];\nintValuePos = streCO2.indexOf(\"value\\\":\");\nintValuePos = intValuePos + 7; // remove value\":\nstreCO2 = streCO2.substring(intValuePos, (intValuePos+8))\nintValuePos = streCO2.indexOf(\",\\\"\");\nstreCO2 = streCO2.substring(0, intValuePos)\nfloateCO2 = parseFloat(streCO2);\nstrSaveData = strSaveData + \"eCO2;\" + streCO2 + \";end;\";\n\n//// Light sensor\nvar strLight = strMainArray[6];\nintValuePos = strLight.indexOf(\"value\\\":\");\nintValuePos = intValuePos + 7; // remove value\":\nstrLight = strLight.substring(intValuePos, (intValuePos+8))\nintValuePos = strLight.indexOf(\",\\\"\");\nstrLight = strLight.substring(0, intValuePos)\nfloatLight = parseFloat(strLight);\nstrSaveData = strSaveData + \"Light;\" + strLight + \";end;\";\n\n//// Battery status\nvar strBat = strMainArray[7];\nintValuePos = strBat.indexOf(\"value\\\":\");\nintValuePos = intValuePos + 7; // remove value\":\nstrBat = strBat.substring(intValuePos, (intValuePos+8))\nintValuePos = strBat.indexOf(\",\\\"\");\nstrBat = strBat.substring(0, intValuePos)\nintBat = parseInt(strBat);\n\n//// Noise sensor\nvar strNoise = strMainArray[8];\nintValuePos = strNoise.indexOf(\"value\\\":\");\nintValuePos = intValuePos + 7; // remove value\":\nstrNoise = strNoise.substring(intValuePos, (intValuePos+8))\nintValuePos = strNoise.indexOf(\",\\\"\");\nstrNoise = strNoise.substring(0, intValuePos)\nfloatNoise = parseFloat(strNoise);\nstrSaveData = strSaveData + \"Noise;\" + strNoise + \";end;\";\n\n//// Pressure sensor\nvar strPressure = strMainArray[9];\nintValuePos = strPressure.indexOf(\"value\\\":\");\nintValuePos = intValuePos + 7; // remove value\":\nstrPressure = strPressure.substring(intValuePos, (intValuePos+8))\nintValuePos = strPressure.indexOf(\",\\\"\");\nstrPressure = strPressure.substring(0, intValuePos)\nfloatPressure = parseFloat(strPressure);\nstrSaveData = strSaveData + \"Pressure;\" + strPressure + \";end;\";\n\n//// Particle matter PM1\nvar strPM1 = strMainArray[10];\nintValuePos = strPM1.indexOf(\"value\\\":\");\nintValuePos = intValuePos + 7; // remove value\":\nstrPM1 = strPM1.substring(intValuePos, (intValuePos+8))\nintValuePos = strPM1.indexOf(\",\\\"\");\nstrPM1 = strPM1.substring(0, intValuePos)\nfloatPM1 = parseFloat(strPM1);\nstrSaveData = strSaveData + \"PM1;\" + strPM1 + \";end;\";\n\n//// Particle matter PM2.5\nvar strPM25 = strMainArray[12];\nintValuePos = strPM25.indexOf(\"value\\\":\");\nintValuePos = intValuePos + 7; // remove value\":\nstrPM25 = strPM25.substring(intValuePos, (intValuePos+8))\nintValuePos = strPM25.indexOf(\",\\\"\");\nstrPM25 = strPM25.substring(0, intValuePos)\nfloatPM25 = parseFloat(strPM25);\nstrSaveData = strSaveData + \"PM2.5;\" + strPM25 + \";end;\";\n\n//// Particle matter PM10\nvar strPM10 = strMainArray[11];\nintValuePos = strPM10.indexOf(\"value\\\":\");\nintValuePos = intValuePos + 7; // remove value\":\nstrPM10 = strPM10.substring(intValuePos, (intValuePos+8))\nintValuePos = strPM10.indexOf(\",\\\"\");\nstrPM10 = strPM10.substring(0, intValuePos)\nfloatPM10 = parseFloat(strPM10);\nstrSaveData = strSaveData + \"PM10;\" + strPM10 + \";end;\";\n\n//// Humidity sensor\nvar strHumidity = strMainArray[13];\nintValuePos = strHumidity.indexOf(\"value\\\":\");\nintValuePos = intValuePos + 7; // remove value\":\nstrHumidity = strHumidity.substring(intValuePos, (intValuePos+8))\nintValuePos = strHumidity.indexOf(\",\\\"\");\nstrHumidity = strHumidity.substring(0, intValuePos)\nfloatHumidity = parseFloat(strHumidity);\nstrSaveData = strSaveData + \"Humidity;\" + strHumidity + \";end;\";\n\n//// Temperature sensor\nvar strTemperature = strMainArray[14];\nintValuePos = strTemperature.indexOf(\"value\\\":\");\nintValuePos = intValuePos + 7; // remove value\":\nstrTemperature = strTemperature.substring(intValuePos, (intValuePos+8))\nintValuePos = strTemperature.indexOf(\",\\\"\");\nstrTemperature = strTemperature.substring(0, intValuePos)\nfloatTemperature = parseFloat(strTemperature);\nstrSaveData = strSaveData + \"Temperature;\" + strTemperature + \";end;\";\n\n//// Prepare output\nvar msg1 = {payload:strSensorInfo};\nvar msg2 = {payload:strDeviceInfo};\nvar msg3 = {payload:strLocationInfo};\nvar msg4 = {payload:strTimeInfo};\nvar msg5 = {payload:floatTVOC};\nvar msg6 = {payload:floateCO2};\nvar msg7 = {payload:floatLight};\nvar msg8 = {payload:intBat};\nvar msg9 = {payload:floatNoise};\nvar msg10 = {payload:floatPressure};\nvar msg11 = {payload:floatPM1};\nvar msg12 = {payload:floatPM25};\nvar msg13 = {payload:floatPM10};\nvar msg14 = {payload:floatHumidity};\nvar msg15 = {payload:floatTemperature};\nvar msg16 = {payload:strSaveData};\n\nreturn [msg1,msg2,msg3,msg4,msg5,msg6,msg7,msg8,msg9,msg10,msg11,msg12,msg13,msg14,msg15,msg16];","outputs":16,"noerr":0,"initialize":"","finalize":"","libs":[],"x":690,"y":460,"wires":[[],[],[],[],["41ce0d29.b61ce4"],["720a62b.8f1789c"],["ae63632b.01468"],[],["83f7c275.ec7d1"],["49da8766.797978"],["d29534a8.093b38"],["41861b82.d7fa64"],["c0fe8791.834008"],["c9501cf1.d044d"],["326b4c40.cd8bc4"],["b9c488a2.9d6708"]]},{"id":"37b16b99.31ed34","type":"file","z":"98156df5.ec21f","name":"Save data in file","filename":"/home/pi/DataSavePi.txt","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1120,"y":960,"wires":[[]]},{"id":"b9c488a2.9d6708","type":"function","z":"98156df5.ec21f","name":"Save Data","func":"context.data = context.data || {};\n\n//// Distribute data\nswitch (msg.topic) \n{\n    case \"Timer1\":\n        context.data.Timer1 = msg.payload;\n        msg = null;\n        break;\n    case \"Timer2\":\n        context.data.Timer2 = msg.payload;\n        msg = null;\n        break;\n    case \"Timer3\":\n        context.data.Timer3 = msg.payload;\n        msg = null;\n        break;\n    case \"Timer4\":\n        context.data.Timer4 = msg.payload;\n        msg = null;\n        break;\n    default:\n        context.data.Data = msg.payload;\n        msg = null;\n        break;\n}\n\n// Send data stream with date\nif ((context.data.Timer1) || (context.data.Timer2) || (context.data.Timer3) || (context.data.Timer4))\n{\n    // Check if data exist\n    if (context.data.Data !== undefined) // No undefined -> Data available\n    {\n        // Timestamp\n        var strDataStream = Date();\n        var intUselessInfo = strDataStream.indexOf(\" GMT\");\n        strDataStream = strDataStream.substring(0, intUselessInfo)\n\n        // Add data to string\n        strDataStream = strDataStream + \";\" + context.data.Data;\n    \n        // Reset data\n        context.data = null;\n        msg = {payload:strDataStream};\n        return msg;\n    }\n}\n\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"x":930,"y":960,"wires":[["37b16b99.31ed34"]]},{"id":"8edae401.cfa568","type":"inject","z":"98156df5.ec21f","name":"","repeat":"","crontab":"00 06 * * *","once":false,"onceDelay":0.1,"topic":"Timer1","payload":"","payloadType":"date","x":590,"y":820,"wires":[["b9c488a2.9d6708"]]},{"id":"f1e83d8d.faacc","type":"inject","z":"98156df5.ec21f","name":"","repeat":"","crontab":"00 12 * * *","once":false,"onceDelay":0.1,"topic":"Timer2","payload":"","payloadType":"date","x":590,"y":900,"wires":[["b9c488a2.9d6708"]]},{"id":"d285e15b.9b89","type":"inject","z":"98156df5.ec21f","name":"","repeat":"","crontab":"00 18 * * *","once":false,"onceDelay":0.1,"topic":"Timer3","payload":"","payloadType":"date","x":590,"y":1000,"wires":[["b9c488a2.9d6708"]]},{"id":"fc4e29be.4b7ba8","type":"inject","z":"98156df5.ec21f","name":"","repeat":"","crontab":"00 00 * * *","once":false,"onceDelay":0.1,"topic":"Timer4","payload":"","payloadType":"date","x":590,"y":1080,"wires":[["b9c488a2.9d6708"]]},{"id":"afab497f.5ebf48","type":"ui_gauge","z":"83532572.bb6958","name":"","group":"f0f2a938.972238","order":1,"width":0,"height":0,"gtype":"gage","title":"CPU Temperatur","label":"Â°C","format":"{{value}}","min":0,"max":"80","colors":["#00b500","#e6e600","#ca3838"],"seg1":"30","seg2":"50","x":1110,"y":180,"wires":[]},{"id":"86920ca.696cbf","type":"inject","z":"83532572.bb6958","name":"","repeat":"3","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":210,"y":180,"wires":[["c37ab518.5a92e8","a8366ec6.a306c","3eeea139.67c77e"]]},{"id":"2b272517.c54f0a","type":"function","z":"83532572.bb6958","name":"Data distributor","func":"//// Get array\naMainData = msg.payload;\n\n//// Core 1\nvar intCore1Usage = aMainData[0].usage;\nvar intCore1Speed = aMainData[0].speed;\n\n//// Core 2\nvar intCore2Usage = aMainData[1].usage;\nvar intCore2Speed = aMainData[1].speed;\n\n//// Core 3\nvar intCore3Usage = aMainData[2].usage;\nvar intCore3Speed = aMainData[2].speed;\n\n//// Core 4\nvar intCore4Usage = aMainData[3].usage;\nvar intCore4Speed = aMainData[3].speed;\n\n//// Set output\nmsg1 = {payload:intCore1Usage};\nmsg2 = {payload:intCore1Speed};\nmsg3 = {payload:intCore2Usage};\nmsg4 = {payload:intCore2Speed};\nmsg5 = {payload:intCore3Usage};\nmsg6 = {payload:intCore3Speed};\nmsg7 = {payload:intCore4Usage};\nmsg8 = {payload:intCore4Speed};\n\nreturn [msg1,msg2,msg3,msg4,msg5,msg6,msg7,msg8];","outputs":8,"noerr":0,"initialize":"","finalize":"","libs":[],"x":680,"y":460,"wires":[["65b7dfcd.e7f35"],[],["af8a1356.553f2"],[],["6bcc514b.87521"],[],["b59ac8e4.0436b8"],["613faa5f.fdaff4"]]},{"id":"65b7dfcd.e7f35","type":"ui_chart","z":"83532572.bb6958","name":"","group":"f0f2a938.972238","order":4,"width":"10","height":"3","label":"Core 1 usage","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"100","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":1100,"y":360,"wires":[[]]},{"id":"613faa5f.fdaff4","type":"ui_text","z":"83532572.bb6958","group":"f0f2a938.972238","order":2,"width":"5","height":"1","name":"","label":"Core Speed [MHz]","format":"{{msg.payload}}","layout":"row-spread","x":1110,"y":600,"wires":[]},{"id":"af8a1356.553f2","type":"ui_chart","z":"83532572.bb6958","name":"","group":"f0f2a938.972238","order":5,"width":"10","height":"3","label":"Core 2 usage","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"100","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":1100,"y":420,"wires":[[]]},{"id":"6bcc514b.87521","type":"ui_chart","z":"83532572.bb6958","name":"","group":"f0f2a938.972238","order":6,"width":"10","height":"3","label":"Core 3 usage","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"100","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":1100,"y":480,"wires":[[]]},{"id":"b59ac8e4.0436b8","type":"ui_chart","z":"83532572.bb6958","name":"","group":"f0f2a938.972238","order":7,"width":"10","height":"3","label":"Core 4 usage","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"100","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":1100,"y":540,"wires":[[]]},{"id":"17276393.cc030c","type":"restart","z":"83532572.bb6958","name":"","x":1090,"y":700,"wires":[]},{"id":"3eeea139.67c77e","type":"ui_switch","z":"83532572.bb6958","name":"","label":"Restart Raspberry Pi","tooltip":"","group":"f0f2a938.972238","order":3,"width":"5","height":"1","passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":460,"y":700,"wires":[["2fd5dc0d.083eb4"]]},{"id":"2fd5dc0d.083eb4","type":"switch","z":"83532572.bb6958","name":"","property":"payload","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":690,"y":700,"wires":[["17276393.cc030c"]]},{"id":"c37ab518.5a92e8","type":"cpu","z":"83532572.bb6958","name":"","msgCore":false,"msgOverall":false,"msgArray":true,"msgTemp":false,"x":470,"y":460,"wires":[["2b272517.c54f0a"]]},{"id":"a8366ec6.a306c","type":"cpu","z":"83532572.bb6958","name":"CPU Temperatur","msgCore":false,"msgOverall":false,"msgArray":false,"msgTemp":true,"x":690,"y":180,"wires":[["afab497f.5ebf48"]]},{"id":"ac5ce9fc.419d18","type":"ui_template","z":"98156df5.ec21f","group":"351431f3.12e9ee","name":"Title Fine Dust","order":11,"width":"20","height":"1","format":"<font \nsize=\"5\" \nalign=center \ncolor=#0EB8C0>\n    <b>Fine Dust</b>\n</font>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1120,"y":500,"wires":[[]]},{"id":"d719a791.30c098","type":"ui_template","z":"98156df5.ec21f","group":"351431f3.12e9ee","name":"Title Gas","order":7,"width":"20","height":"1","format":"<font \nsize=\"5\" \nalign=center \ncolor=#0EB8C0>\n    <b>Gas</b>\n</font>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":1100,"y":80,"wires":[[]]},{"id":"52228500.6f92dc","type":"alexa-home","z":"e050fe1f.3b69e","conf":"","device":"150648","acknoledge":true,"name":"","topic":"Clock","x":170,"y":160,"wires":[["a61cf86a.b80878"]]},{"id":"9c1ad1c5.0e355","type":"pi-hole-control","z":"d6cb01d2.47662","confignode":"c01580f9.1f734","command":"toggle","disabletime":"3","statustime":5,"name":"Restart PiHole","all":false,"x":460,"y":60,"wires":[[]]},{"id":"c4e57c9d.c7edf","type":"function","z":"d9a38654.e281d8","name":"Automatic Clock On","func":"//Initialize global variable\nvar ClockOn = global.get('ClockOn');\n\n//Check if global variable is undefined\nif (ClockOn !== undefined)\n{\n    ClockOn = 2; // On\n\n    //Set global variable\n    global.set('ClockOn', ClockOn);\n}","outputs":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":420,"y":620,"wires":[]},{"id":"c5bfd4f2.cd77e8","type":"inject","z":"d9a38654.e281d8","name":"Automatic On","repeat":"","crontab":"30 05 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":620,"wires":[["c4e57c9d.c7edf"]]},{"id":"5a646ab3.8940d4","type":"inject","z":"d9a38654.e281d8","name":"Automatic Off","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"59 23 * * *","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":680,"wires":[["281e5b70.633744"]]},{"id":"281e5b70.633744","type":"function","z":"d9a38654.e281d8","name":"Automatic Clock Off","func":"//Initialize global variable\nvar ClockOn = global.get('ClockOn');\n\n//Check if global variable is undefined\nif (ClockOn !== undefined)\n{\n    ClockOn = 3; // Off\n\n    //Set global variable\n    global.set('ClockOn', ClockOn);\n}","outputs":0,"noerr":0,"x":410,"y":680,"wires":[]},{"id":"a61cf86a.b80878","type":"function","z":"e050fe1f.3b69e","name":"Automatic Clock On","func":"//Initialize global variable\nvar ClockOn = global.get('ClockOn');\n\n//Check if global variable is undefined\nif (ClockOn !== undefined)\n{\n    if (msg.payload === true)\n    {\n        ClockOn = 2; // On\n    }\n    else\n    {\n        ClockOn = 3; // Off\n    }\n    \n\n    //Set global variable\n    global.set('ClockOn', ClockOn);\n}","outputs":0,"noerr":0,"x":340,"y":160,"wires":[]},{"id":"d11d2552.33d298","type":"debug","z":"d6cb01d2.47662","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":500,"y":1000,"wires":[]}]